(function(){var e={7555:function(e,t){const r="/book_release_info_data/";async function o(e){e.endsWith(".json")||(e+=".json");let t=await fetch(r+e+`?t=${(new Date).toISOString()}`);if(200!=t.status)return console.log(`${e}: ${t.status}`),null;let o=await t.json(),a={};o.forEach((e=>{let t=s(e.title);a[t]||(a[t]=[]),a[t].push(e)}));let i=[];for(const r in a){const e=a[r];e.sort(c),i.push({key:r,records:e})}for(let r=0;r<i.length;r++){const e=n(i[r].records,"isbn");if(e)for(let t=r+1;t<i.length;t++)if(e==n(i[t].records,"isbn")){const e=i.splice(t,1)[0];i[r].key=c(i[r].records[0],e.records[0])<0?i[r].key:e.key,i[r].records.push(...e.records),i[r].records.sort(c)}}return i.sort(((e,t)=>e.records[0].date.localeCompare(t.records[0].date))),console.log(e+":"),console.log(i),i}function n(e,t){for(const r of e)if(t in r)return r[t]}function s(e){let t=e;return t=t.replace(/[\uFF10-\uFF19]/g,(e=>String.fromCharCode(e.charCodeAt(0)-65248))),t=t.replace(/[\u2460-\u2473]/g,(e=>String.fromCharCode(e.charCodeAt(0)-9312+49))),t=t.replace(/[(（][^0-9]*?[）)]/g,""),t=t.replace(/[(（]([0-9]*?)[）)]/g,(e=>e[1])),t=t.replace(/[0-9]+/g,(e=>parseInt(e))),t=t.replaceAll("　","").replaceAll(" ",""),t=t.trim(),t}const a={"https://www.ktcom.jp/new_release.htm":1,"https://bookclub.kodansha.co.jp/calendar":-1,"https://kc.kodansha.co.jp/calendar":-1,"https://dengekibunko.jp/product/newrelease-bunko.html":-1,"https://gagagabunko.jp/release/index.html":-1,"https://fantasiabunko.jp/":-1,"手書き":0},i={"hon-hikidashi.jp":-10,"www.amazon.co.jp":5};function l(e){const t=e.source;if(t in a)return a[t];let r=t.split("/");if(r.length<3)return 0;const o=r[2];return o in i?i[o]:0}function c(e,t){const r=l(e),o=l(t);return r!=o?o-r:-e.recordTime.localeCompare(t.recordTime)}t.GetData=o,t.CompareRecords=c,t.data_root=r},9019:function(e,t,r){"use strict";var o=r(9242),n=r(3396),s=r(7139);const a=(0,n._)("header",{class:"main_width"},[(0,n._)("h1",null,"新刊情報強者になろう")],-1),i={id:"filter_settings",class:"main_width"},l=(0,n._)("option",{disabled:"",value:""},"---",-1),c=(0,n.Uk)(" Filter："),u=["onClick"],d=(0,n._)("option",null,"Record Date",-1),h=(0,n._)("option",null,"Release Date",-1),p=[d,h],f={id:"content",class:"main_width"},_=(0,n._)("footer",null,"本サイトは新刊のデータに関する権利を持っていません。",-1);function k(e,t,r,d,h,k){const w=(0,n.up)("list-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[a,(0,n._)("div",i,[(0,n._)("div",null,[(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>h.input_current_label=e)},[l,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(k.labels,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e},(0,s.zw)(e),1)))),128))],512),[[o.bM,h.input_current_label]]),(0,n._)("button",{onClick:t[1]||(t[1]=e=>k.AddFilter("+"))},"+"),(0,n._)("button",{onClick:t[2]||(t[2]=e=>k.AddFilter("-"))},"-"),(0,n._)("span",null,"Selected: "+(0,s.zw)(h.input_current_label),1)]),(0,n._)("div",null,[c,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.filters,(e=>((0,n.wg)(),(0,n.iD)("span",{class:"filter_item",key:e.value},[(0,n.Uk)((0,s.zw)(e.operation)+(0,s.zw)(e.value),1),(0,n._)("span",{class:"remove_filter",onClick:t=>k.RemoveFilter(e)},"×",8,u)])))),128))]),(0,n._)("div",null,[(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.sort_method=e),onChange:t[4]||(t[4]=e=>k.SortBooks())},p,544),[[o.bM,h.sort_method]])])]),(0,n._)("div",f,[(0,n._)("div",{style:{cursor:"pointer","text-align":"center"},onClick:t[5]||(t[5]=e=>k.LoadLast())}," LAST MONTH "),(0,n.Wm)(w,{books:k.books_display,data_root:h.data_root},null,8,["books","data_root"]),(0,n._)("div",{style:{cursor:"pointer","text-align":"center"},onClick:t[6]||(t[6]=e=>k.LoadNext())}," NEXT MONTH ")]),_],64)}const w={class:"list_view"},g=["data-key"],b={class:"cover_container"},m=["src","title"],v={class:"book_info"},y={class:"book_title"},D={class:"info_values"};function j(e,t,r,o,a,i){const l=(0,n.up)("display-creators"),c=(0,n.up)("display-record-source");return(0,n.wg)(),(0,n.iD)("div",w,[(0,n._)("ul",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.books,(e=>((0,n.wg)(),(0,n.iD)("li",{key:e.key,"data-key":e.key},[(0,n._)("div",b,[(0,n._)("img",{src:e.records[0].coverFile?r.data_root+e.records[0].coverFile:"cover_dummy.jpg",title:e.records[0].coverFile?`${e.records[0].coverSize.w}x${e.records[0].coverSize.h}`:""},null,8,m)]),(0,n._)("div",v,[(0,n._)("p",y,(0,s.zw)(e.records[0].title),1),(0,n.Wm)(l,{record:e.records[0]},null,8,["record"]),(0,n._)("p",D,[(0,n._)("span",null,"発売日："+(0,s.zw)(e.records[0].date)+" 　",1),(0,n._)("span",null,"レーベル："+(0,s.zw)(e.records[0].label),1)]),(0,n.Wm)(c,{record:e.records[0]},null,8,["record"])])],8,g)))),128))])])}const C={class:"record_source"},L=(0,n.Uk)("情報源： "),O=["href","title"],F={key:1};function M(e,t,r,o,a,i){return(0,n.wg)(),(0,n.iD)("span",C,[(0,n._)("span",null,"初記録："+(0,s.zw)(r.record.recordTime)+"　",1),(0,n._)("span",null,"Last Check："+(0,s.zw)(r.record.lastCheckTime)+"　",1),(0,n._)("span",null,[L,r.record.source.startsWith("http")?((0,n.wg)(),(0,n.iD)("a",{key:0,href:r.record.source,title:r.record.source,target:"_blank"},"🔗"+(0,s.zw)(i.link2Name(r.record.source)),9,O)):((0,n.wg)(),(0,n.iD)("span",F,(0,s.zw)(r.record.source),1))])])}var S={name:"DisplayRecordSource",props:{record:Object},methods:{link2Name(e){switch(e){case"https://www.ktcom.jp/new_release.htm":return"公式サイト（KTC，発売予定ページ）";case"https://bookclub.kodansha.co.jp/calendar":return"公式サイト（講談社，書籍発売予定ページ）";case"https://kc.kodansha.co.jp/calendar":return"公式サイト（講談社，マンガ発売予定ページ）";case"https://dengekibunko.jp/product/newrelease-bunko.html":return"公式サイト（電撃文庫，発売予定ページ）";case"https://gagagabunko.jp/release/index.html":return"公式サイト（ガガガ文庫，発売予定ページ）";case"https://fantasiabunko.jp/":return"公式サイト（ファンタジア文庫）"}let t=e.split("/");if(t.length<3)return"Link";let r=t[2];switch(r){case"www.kadokawa.co.jp":return"公式サイト (KADOKAWA)";case"hon-hikidashi.jp":return"ほんのひきだし";case"www.amazon.co.jp":return"Amazon JP"}return console.log("Unknown source: "+e),"Link"}}},z=r(89);const A=(0,z.Z)(S,[["render",M],["__scopeId","data-v-d4bc7e7e"]]);var x=A;const R={class:"creators"},T={class:"creator_refine"},I={class:"creator_name"},N=(0,n.Uk)("　");function H(e,t,r,o,a,i){return(0,n.wg)(),(0,n.iD)("span",R,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.record.creators,((e,t)=>((0,n.wg)(),(0,n.iD)("span",{class:"creator_container",key:e},[(0,n._)("span",T,(0,s.zw)(i.getRefine(t)),1),(0,n._)("span",I,(0,s.zw)(e.replaceAll("　"," ")),1),N])))),128))])}var K={name:"DisplayCreators",props:{record:Object},methods:{getRefine(e){if(!this.record.creator_refines)return"";let t=this.record.creator_refines[e];return t?t+"・":""}}};const U=(0,z.Z)(K,[["render",H],["__scopeId","data-v-443acb93"]]);var E=U,W={name:"ListView",props:{books:Array,data_root:String},components:{DisplayRecordSource:x,DisplayCreators:E}};const Y=(0,z.Z)(W,[["render",j],["__scopeId","data-v-3e978976"]]);var $=Y,B=r(7555),G={name:"App",data(){return{books:[],filters:[],lastMonth:null,viewingMonth:null,data_root:B.data_root,dateLine:"",input_current_label:"",sort_method:"Release Date",displayEarlyInfo:!1}},components:{ListView:$},async mounted(){let e=new Date;e.setDate(e.getDate()-7),this.dateLine=e.toISOLikeDate(),console.log("基準:"+this.dateLine),this.viewingMonth=e,this.lastMonth=new Date(e),this.books=await B.GetData(this.viewingFile()),this.LoadNext()},methods:{async LoadNext(){try{this.viewingMonth.setMonth(this.viewingMonth.getMonth()+1);let e=await B.GetData(this.viewingFile());if(!(e&&e.length>0))return;for(const t of e){const e=this.books.find((e=>e.key==t.key));e?(e.records.push(...t.records),e.records.sort(B.CompareRecords)):this.books.push(t)}this.SortBooks(),this.LoadNext()}catch(e){console.log(e)}},async LoadLast(){this.displayEarlyInfo=!0;try{this.lastMonth.setMonth(this.lastMonth.getMonth()-1);let e=await B.GetData(this.lastFile());if(!(e&&e.length>0))return;for(const t of e){const e=this.books.find((e=>e.key==t.key));e?(e.records.push(...t.records),e.records.sort(B.CompareRecords)):this.books.push(t)}this.SortBooks(),this.LoadNext()}catch(e){console.log(e)}},viewingFile(){return this.viewingMonth.toISOLikeDate().substring(0,7)},lastFile(){return this.lastMonth.toISOLikeDate().substring(0,7)},AddFilter(e){if(!this.input_current_label)return;let t=this.filters.filter((e=>e.value==this.input_current_label));t.length>0?t[0].operation=e:this.filters.push({operation:e,value:this.input_current_label})},RemoveFilter(e){this.filters=this.filters.filter((t=>t!=e))},SortBooks(){const e=V[this.sort_method];this.books.sort(e)}},computed:{labels(){return[...new Set(Array.from(this.books,(e=>e.records[0].label)))]},books_display(){let e=this.books;if(this.displayEarlyInfo||(e=e.filter((e=>e.records[0].date.localeCompare(this.dateLine)>=0))),0==this.filters.length)return e;const t="+"!=this.filters[0].operation;return e.filter((e=>{for(const t of this.filters)if(e.records[0].label==t.value){if("+"==t.operation)return!0;if("-"==t.operation)return!1}return t}))}},watch:{books_display(e){console.log("filter changed:"),console.log(e)}}};const V={"Release Date":(e,t)=>e.records[0].date.localeCompare(t.records[0].date),"Record Date":(e,t)=>-e.records[0].recordTime.localeCompare(t.records[0].recordTime)},Z=(0,z.Z)(G,[["render",k]]);var P=Z;function J(e){return e<10?"0"+e:e}Date.prototype.toISOLikeDate=function(){return this.getFullYear()+"-"+J(this.getMonth()+1)+"-"+J(this.getDate())},(0,o.ri)(P).mount("#app")}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,o,n,s){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],n=e[u][1],s=e[u][2];for(var i=!0,l=0;l<o.length;l++)(!1&s||a>=s)&&Object.keys(r.O).every((function(e){return r.O[e](o[l])}))?o.splice(l--,1):(i=!1,s<a&&(a=s));if(i){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[o,n,s]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,s,a=o[0],i=o[1],l=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(l)var u=l(r)}for(t&&t(o);c<a.length;c++)s=a[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},o=self["webpackChunkwebapp"]=self["webpackChunkwebapp"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=r.O(void 0,[998],(function(){return r(9019)}));o=r.O(o)})();
//# sourceMappingURL=app.306e3552.js.map